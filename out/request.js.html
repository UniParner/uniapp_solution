<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: request.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: request.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import host from '../config/host.js'

const reponseResolver = (response, resolve, reject) => {
	if (response.data &amp;&amp; response.data.code == 0) {
		console.log('处理成功结果')
		resolve(response.data.data)
	} else {
		console.log('处理失败结果')
		reject(response.data)
	}
}

/**
 * 网络请求，默认为POST请求
 * @see {@link file://./storageutils.js}
 * @param {Object} config -  参考[uni.request的参数]{@link https://uniapp.dcloud.io/api/request/request?id=request}里面的url属性从
 * @param {String|undefined} otherhost -  默认使用的
 */
const request = (config, otherhost = undefined, reponsePlugin = reponseResolver) => {
	return new Promise((resolve, reject) => {
		const method = config.method ? config.method : 'POST'
		const finalHost = otherhost ? otherhost : host
		const { url } = config
		const requestParams = { ...config, url: `${finalHost}${url}`, method }
		const success = (response) => {
			console.log(`请求参数`, requestParams, '请求结果：', response)
			if (reponsePlugin) {
				reponsePlugin(response, resolve, reject)
				return
			}
			resolve(response)
		}
		const fail = (error) => {
			console.log(`请求参数`, ...requestParams, '请求失败：', error)
			reject(error)
		}
		const finalConfig = { ...requestParams, success, fail }
		uni.request(finalConfig)
	})
}

module.exports = request
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#request">request</a></li><li><a href="global.html#saveCurrentUser">saveCurrentUser</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Thu Jun 18 2020 17:10:11 GMT+0800 (China Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
